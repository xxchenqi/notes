# 音频基础知识

## 1.声音基本概念

**声音如何产生的？**

声音是由物体振动产生的

**声音如何传输的？**

它可以通过空气、固体、液体等进行传输

**人如何识别声音？**

传输后，振动耳膜，经过大脑神经系统产生信号进行识别，识别出具体什么声音

**人耳如何处理声音？**

耳廓将很小的声音聚拢到一起，通过耳道传递进去，使声音有增大效果，耳道越长说明听觉越敏感。

经过耳道后进行鼓膜的振动后进入听觉神经系统，在与大脑进行连接进行识别。



## 2.人类的听觉范围

小于20hz为次声波(人类无感知的)

20HZ - 20KHZ 为可听声波

大于20KHZ为超声波(人类无感知的)

hz：赫兹，1秒钟振动的次数

举个例子：

人发声频率：85~1100hz

人听觉频率：20~20000hz



## 3.声音的三要素

音调：音频的快慢，音频越高声音就越悦耳

音量：振动的幅度，振动幅度越大音量就越大

音色：谐波（不同人和不同乐器声音的音色是通过谐波产生的）



## 4.模数转换

模拟信号转换为数字信号。

如何转换？

1.采样

对一段声音进行量化采样，采样率越高还原度就越高。

假设每0.25进行采样，0.25位置的声音值是多少，0.5是多少。。。等

采样完成后数字化的信息就出来了。

2.十进制转换成二进制，给计算机识别



## 5.音频原始数据格式

PCM：音频原始数据

WAV：在PCM数据之上套一个头(基本信息)



## 6.量化基本概念

采样大小(位深)：一个采样用多少bit存放，常用16bit

位声越高，描述的峰值就越大，声音就更清楚



采样率：常见频率 8k(打电话)、16k、32k、44.1k、48k

采样率越高，数字信号就越接近模拟信号,误差就越小。



声道数：单声道、双声道、多声道



## 7.码率计算

PCM音频流的码率：采样率 * 采样大小  * 声道数

例如

采样率为44.1KHz，采样大小16bit，双声道。

44.1k * 2 * 16 = 1411.2Kb/s



## 8.音频有损压缩

消除冗余信息：消除20hz以下、20000hz以上的数据。这些数据人听不到，所以可以消除。

遮蔽：频域遮蔽、时域遮蔽



## 9.音频无损编码

压缩后在解压能完全还原回原数据。例:zip，rar，7z

熵编码：哈夫曼编码、算数编码、香农编码

哈夫曼编码：通过使用频率来计算节点的位置



## 10.音频编码过程

->时域转频域变化

->心理声学模型



->量化编码->比特流格式化



## 11.音频编码器

OPUS:较新的编码器，延迟小，压缩率高 ，时事通讯，音频会议

AAC:应用最广泛

Ogg：收费

Speex：支持回音消除

G.711：用于固话，窄带音频，编码后的数据特别小，但是损耗特别大。

评测结果：OPUS>AAC>Ogg



## 12.AAC编码器

常用规格：AAC LC、AAC HE V1、AAC HE V2

AAC LC是最基础的：低复杂度规格，码流128k，音质好

码流越大，存储的信息量就越大，清晰度和保真度就越好

码流越小，去除的冗余信息多，声音造成损伤



AAC LC + SBR = AAC HE V1

核心思想：按频谱分保存。低频保存主要成分，高频单独放大编码保存音质。码流64k左右。



AAC HE V1 + PS = AAC HE V2

核心思想：双声道的声音存在某种相似性，只需存储一个声道的全部信息，另一个声道只要用很少的字节参数描述不同的地方。进一步减少码流的大小。



## 13.AAC格式

ADIF(Audio Data Interchange Format)：找到音频数据的开始，只能从头开始解码。常用在磁盘文件中。

ADTS(Audio Data Transport Stream)：每一帧都有一个同步字，可以再音频流的任何位置开始解码。



## 14.ADTS结构

ADTS有7/9个字节组成

http://www.p23.nl/projects/aac-header/



## 15.ffmpeg生成AAC文件

```
fmpeg -i xxx.mp4 -vn -c:a libfdk_aac -ar 44100 -channels 2 -profile:a aac_he_v2 3.aac

-vn:video no 将视频过滤
-c:a codec编码器 audio音频 fdk_aac 性能最好
-ar 音频采光率
-channels 通道数
-profile:a  参数 a 音频

```

## 16.音频重采样

将音频三元组(采样率、采样大小和通道数)的值转成另外一组值

例如：44100/16/2 转成 48000/16/2



## 17.为什么要重采样

1.从设备采集的音频数据与编码器要求的数据不一致

2.扬声器要求的音频数据与要播放的音频数据不一致

3.更方便运算

例：回音消除



## 18.如何知道是否需要重采样

1.了解音频设备的参数

2.查看ffmpeg源码

